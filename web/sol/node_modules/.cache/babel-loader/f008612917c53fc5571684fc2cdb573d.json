{"ast":null,"code":"var _jsxFileName = \"/home/dan/Documents/sol/sol/src/App.js\";\nimport React, { useRef } from 'react';\nimport * as tf from \"@tensorflow/tfjs\";\nimport * as bodyPix from \"@tensorflow-models/body-pix\";\nimport Webcam from \"react-webcam\";\nimport './App.css';\nimport backVideo from './airport.mp4';\n\nfunction App() {\n  const webcamRef = useRef(null);\n  const canvasRef = useRef(null);\n  const backVideoRef = useRef(null);\n\n  const runBodySegment = async () => {\n    const net = await bodyPix.load();\n    console.log(backVideoRef);\n\n    if (backVideoRef.current) {\n      backVideoRef.current.play();\n    } // backVideoRef.play();\n\n\n    detect(net); // setInterval(() => {\n    // \tdetect(net);\n    // }, 100);\n  };\n\n  const backMask = function (image, mask) {\n    console.log(image, mask);\n\n    for (let i = 0; i < image.data.length; i += 4) {\n      const vector = [image.data[i], image.data[i + 1], image.data[i + 2], image.data[i + 3]];\n\n      if (vector[0] === 255 && vector[1] === 255 && vector[2] === 255) {\n        mask.data[i] = 0;\n        mask.data[i + 1] = 0;\n        mask.data[i + 2] = 0;\n        mask.data[i + 3] = 0;\n      } else {\n        mask.data[i] = image.data[i];\n        mask.data[i + 1] = image.data[i + 1];\n        mask.data[i + 2] = image.data[i + 2];\n        mask.data[i + 3] = image.data[i + 3];\n      }\n    }\n\n    return mask;\n  };\n\n  const detect = async net => {\n    if (typeof webcamRef.current !== \"undefined\" && webcamRef.current !== null && webcamRef.current.video.readyState === 4) {\n      const video = webcamRef.current.video;\n      const videoHeight = video.videoHeight;\n      const videoWidth = video.videoWidth;\n      webcamRef.current.video.height = videoHeight;\n      webcamRef.current.video.width = videoWidth;\n      canvasRef.current.width = videoWidth;\n      canvasRef.current.height = videoHeight;\n      const outStride = 16;\n      const segThreshold = 0.5;\n      const cv = document.createElement('canvas');\n      cv.width = 640;\n      cv.height = 480;\n      const ctx = cv.getContext('2d');\n      ctx.drawImage(video, 0, 0, cv.width, cv.height);\n      const imageData = ctx.getImageData(0, 0, cv.width, cv.height);\n      console.log();\n      const person = await net.segmentPersonParts(video, outStride, segThreshold);\n      console.log(person);\n      const coloredPart = bodyPix.toColoredPartMask(person);\n      const back = backMask(imageData, coloredPart);\n      console.log(back);\n      const ctx2 = canvasRef.current.getContext('2d');\n      ctx2.drawImage(back, 0, 0, cv.width, cv.height); // bodyPix.drawMask(\n      // \tcanvasRef.current,\n      // \tvideo,\n      // \tback,\n      // \t0.6,\n      // \t0,\n      // \tfalse\n      // )\n    }\n  };\n\n  runBodySegment();\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"header\", {\n    className: \"App-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Webcam, {\n    ref: webcamRef,\n    style: {\n      visibility: \"hidden\",\n      position: \"absolute\",\n      marginLeft: \"auto\",\n      marginRight: \"auto\",\n      left: 0,\n      right: 0,\n      textAlign: \"center\",\n      zIndex: 9,\n      width: 640,\n      height: 480\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(\"canvas\", {\n    ref: canvasRef,\n    style: {\n      position: \"absolute\",\n      marginLeft: \"auto\",\n      marginRight: \"auto\",\n      left: 0,\n      right: 0,\n      textAlign: \"center\",\n      zIndex: 9,\n      width: 640,\n      height: 480,\n      backgroundColor: \"transparent\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 3\n    }\n  }), /*#__PURE__*/React.createElement(\"video\", {\n    ref: backVideoRef,\n    style: {\n      position: \"absolute\",\n      // marginTop:0,\n      marginLeft: \"auto\",\n      marginRight: \"auto\",\n      left: 0,\n      // top:0,\n      // opacity:0.3,\n      right: 0,\n      textAlign: \"center\",\n      zIndex: 8,\n      width: 640,\n      height: 480,\n      objectFit: \"cover\"\n    },\n    width: \"640\",\n    height: \"480\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"source\", {\n    src: backVideo,\n    type: \"video/mp4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 4\n    }\n  }))));\n}\n\nexport default App;","map":{"version":3,"sources":["/home/dan/Documents/sol/sol/src/App.js"],"names":["React","useRef","tf","bodyPix","Webcam","backVideo","App","webcamRef","canvasRef","backVideoRef","runBodySegment","net","load","console","log","current","play","detect","backMask","image","mask","i","data","length","vector","video","readyState","videoHeight","videoWidth","height","width","outStride","segThreshold","cv","document","createElement","ctx","getContext","drawImage","imageData","getImageData","person","segmentPersonParts","coloredPart","toColoredPartMask","back","ctx2","visibility","position","marginLeft","marginRight","left","right","textAlign","zIndex","backgroundColor","objectFit"],"mappings":"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","sourcesContent":["import React, { useRef } from 'react';\nimport * as tf from \"@tensorflow/tfjs\";\nimport * as bodyPix from \"@tensorflow-models/body-pix\";\nimport Webcam from \"react-webcam\";\nimport './App.css';\nimport backVideo from './airport.mp4';\n\nfunction App() {\n\tconst webcamRef = useRef(null);\n\tconst canvasRef = useRef(null);\n\tconst backVideoRef = useRef(null);\n\n\tconst runBodySegment = async () => {\n\t\tconst net = await bodyPix.load();\n\t\tconsole.log(backVideoRef);\n\t\tif (backVideoRef.current) {\n\t\t\tbackVideoRef.current.play();\n\t\t}\n\t\t// backVideoRef.play();\n\t\tdetect(net);\n\t\t// setInterval(() => {\n\t\t// \tdetect(net);\n\t\t// }, 100);\n\t}\n\tconst backMask = function (image, mask) {\n\t\tconsole.log(image, mask);\n\t\tfor (let i = 0; i < image.data.length; i+=4) {\n\t\t\tconst vector = [\n\t\t\t\timage.data[i],\n\t\t\t\timage.data[i + 1],\n\t\t\t\timage.data[i + 2],\n\t\t\t\timage.data[i + 3],\n\t\t\t]\n\t\t\tif (\n\t\t\t\tvector[0] === 255 &&\n\t\t\t\tvector[1] === 255 &&\n\t\t\t\tvector[2] === 255\n\t\t\t\t) {\n\t\t\t\t\tmask.data[i] = 0\n\t\t\t\t\tmask.data[i + 1] = 0\n\t\t\t\t\tmask.data[i + 2] = 0\n\t\t\t\t\tmask.data[i + 3] = 0\n\t\t\t} else {\n\t\t\t\tmask.data[i] = image.data[i];\n\t\t\t\tmask.data[i + 1] = image.data[i + 1];\n\t\t\t\tmask.data[i + 2] = image.data[i + 2];\n\t\t\t\tmask.data[i + 3] = image.data[i + 3];\n\t\t\t}\n\t\t}\n\n\t\treturn mask;\n\t}\n\n\tconst detect = async (net) => {\n\t\tif (\n\t\t\ttypeof webcamRef.current !== \"undefined\" &&\n\t\t\twebcamRef.current !== null &&\n\t\t\twebcamRef.current.video.readyState === 4\n\t\t\t) {\n\t\t\t\tconst video = webcamRef.current.video;\n\t\t\t\tconst videoHeight = video.videoHeight;\n\t\t\t\tconst videoWidth = video.videoWidth;\n\n\t\t\t\twebcamRef.current.video.height = videoHeight;\n\t\t\t\twebcamRef.current.video.width = videoWidth;\n\n\t\t\t\tcanvasRef.current.width = videoWidth;\n\t\t\t\tcanvasRef.current.height = videoHeight;\n\n\t\t\t\tconst outStride = 16;\n\t\t\t\tconst segThreshold = 0.5;\n\t\t\t\tconst cv = document.createElement('canvas');\n\t\t\t\tcv.width = 640;\n\t\t\t\tcv.height = 480;\n\t\t\t\tconst ctx = cv.getContext('2d');\n\t\t\t\tctx.drawImage(video, 0, 0, cv.width, cv.height);\n\t\t\t\tconst imageData = ctx.getImageData(0, 0, cv.width, cv.height);\n\t\t\t\tconsole.log();\n\t\t\t\tconst person = await net.segmentPersonParts(video, outStride, segThreshold);\n\t\t\t\tconsole.log(person);\n\n\t\t\t\tconst coloredPart = bodyPix.toColoredPartMask(person);\n\t\t\t\tconst back = backMask(imageData, coloredPart);\n\t\t\t\tconsole.log(back);\n\t\t\t\tconst ctx2 = canvasRef.current.getContext('2d');\n\t\t\t\tctx2.drawImage(back, 0, 0, cv.width, cv.height);\n\t\t\t\t// bodyPix.drawMask(\n\t\t\t\t// \tcanvasRef.current,\n\t\t\t\t// \tvideo,\n\t\t\t\t// \tback,\n\t\t\t\t// \t0.6,\n\t\t\t\t// \t0,\n\t\t\t\t// \tfalse\n\t\t\t\t// )\n\t\t\t}\n\t}\n\n\trunBodySegment();\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n\t   <Webcam ref={webcamRef}\n\t\t\tstyle = {{\n\t\t\t\tvisibility: \"hidden\",\n\t\t\t\tposition:\"absolute\",\n\t\t\t\tmarginLeft:\"auto\",\n\t\t\t\tmarginRight:\"auto\",\n\t\t\t\tleft:0,\n\t\t\t\tright:0,\n\t\t\t\ttextAlign:\"center\",\n\t\t\t\tzIndex:9,\n\t\t\t\twidth:640,\n\t\t\t\theight:480\n\t\t\t}} />\n\t\t<canvas ref={canvasRef}\n\t\t\tstyle = {{\n\t\t\t\tposition:\"absolute\",\n\t\t\t\tmarginLeft:\"auto\",\n\t\t\t\tmarginRight:\"auto\",\n\t\t\t\tleft:0,\n\t\t\t\tright:0,\n\t\t\t\ttextAlign:\"center\",\n\t\t\t\tzIndex:9,\n\t\t\t\twidth:640,\n\t\t\t\theight:480,\n\t\t\t\tbackgroundColor: \"transparent\"\n\t\t\t}} />\n\t\t<video \n\t\t\tref={ backVideoRef }\n\t\t\tstyle = {{\n\t\t\t\tposition:\"absolute\",\n\t\t\t\t// marginTop:0,\n\t\t\t\tmarginLeft:\"auto\",\n\t\t\t\tmarginRight:\"auto\",\n\t\t\t\tleft:0,\n\t\t\t\t// top:0,\n\t\t\t\t// opacity:0.3,\n\t\t\t\tright:0,\n\t\t\t\ttextAlign:\"center\",\n\t\t\t\tzIndex:8,\n\t\t\t\twidth:640,\n\t\t\t\theight:480,\n\t\t\t\tobjectFit:\"cover\"\n\t\t\t}}\n\t\t\twidth=\"640\"\n\t\t\theight=\"480\">\n\t\t\t<source src={ backVideo } type=\"video/mp4\"/>\n\t\t</video>\n      </header>\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}